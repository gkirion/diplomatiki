var PercentTable;!function(PercentTable_1){function init(table){return new PercentTable(table)}var PercentTable=function(){function PercentTable(table){this.table=[],this.triggeredEvents=[],this.populateTable(table)}return PercentTable.prototype.populateTable=function(table){"undefined"!=typeof table&&table&&this.setTable(table)},PercentTable.prototype.update=function(time){var _this=this;return this.table.forEach(function(value){time>=value.percent&&_this.trigger(value.percent)}),this},PercentTable.prototype.on=function(event,cb){var found=!1;return this.table.forEach(function(value){event===value.percent&&(value.events.push(cb),found=!0)}),found||this.table.push({events:[cb],percent:event}),this},PercentTable.prototype.trigger=function(event){var _this=this;return this.table.forEach(function(value,key){_this.addTriggeredEvent(event),value.percent===event&&(value.events.forEach(function(cb){cb()}),delete _this.table[key])}),this},PercentTable.prototype.setTable=function(table){this.table=table},PercentTable.prototype.getTable=function(){return this.table},PercentTable.prototype.addTriggeredEvent=function(event){this.triggeredEvents.push(event)},PercentTable.prototype.setTriggeredEvents=function(events){this.triggeredEvents=events},PercentTable.prototype.getTriggeredEvents=function(){return this.triggeredEvents},PercentTable}();PercentTable_1.init=init}(PercentTable||(PercentTable={}));var VideoTrackerPlus=function(){function VideoTrackerPlus(el,$f,table,meta){void 0===meta&&(meta={}),this.FROOGALOOPS={PROGRESS_EVENT:"playProgress"},this.meta=meta,el.src&&el.src.indexOf("player_id")===-1&&console.warn("Froogaloops requires the player_id param is set in the src"),this.createVideoName(el);var percentTable=PercentTable.init(table);percentTable=this.registerVideoTracking(percentTable);var vimeo=$f(el);vimeo.addEvent(this.FROOGALOOPS.PROGRESS_EVENT,function(event){var percent=event.percent;percentTable.update(Math.floor(100*percent))}),this.percentTable=percentTable}return VideoTrackerPlus.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},VideoTrackerPlus.prototype.registerVideoTracking=function(percentTable){var _this=this;return percentTable.on(0,function(){_this.track(0)}).on(10,function(){_this.track(10)}).on(25,function(){_this.track(25)}).on(50,function(){_this.track(50)}).on(75,function(){_this.track(75)}).on(90,function(){_this.track(90)}).on(100,function(){_this.track(100)}),percentTable},VideoTrackerPlus.prototype.createVideoName=function(video){this.videoName=video.src.split("?")[0].replace(/^.*\/\/[^\/]+/,"")},VideoTrackerPlus.prototype.track=function(percent){var type;type=0===percent?"start":100===percent?"complete":String(percent);var params={videoName:this.videoName,type:type,category:null};"string"==typeof this.meta.category&&(params.category=this.meta.category),$.publish("analytics.demo.trackVideoPercentage",params)},VideoTrackerPlus.prototype.on=function(event,cb){this.percentTable.on(event,cb)},VideoTrackerPlus}();